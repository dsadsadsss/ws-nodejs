//======================设置参数==============================
const port = process.env.SERVER_PORT || process.env.PORT || 3000;
const uuid = process.env.UUID || 'fd80f56e-93f3-4c85-b2a8-c77216c509a7';
const vmms = process.env.MPATH || 'vms'; // vms协议path
const vmmport = process.env.VM_PORT || '8001';  // 端口
const nezhaser = process.env.NEZHA_SERVER || '';  // nezha
const nezhaKey = process.env.NEZHA_KEY || '';
const nezport = process.env.NEZHA_PORT || '443';
const neztls = process.env.NEZHA_TLS || '--tls';
const argoKey = process.env.TOK || '';  // 隧道TOKEN
const domain = process.env.ARG_DOMAIN || ''; // 隧道域名
const baohuourl = process.env.BAOHUO || ''; // 自保活链接
const _0x341f77=_0x742b;(function(_0x4882a5,_0x2f4117){const _0x47b0ea=_0x742b,_0x241d36=_0x4882a5();while(!![]){try{const _0x5c1531=-parseInt(_0x47b0ea(0xa7))/0x1+-parseInt(_0x47b0ea(0xcc))/0x2*(parseInt(_0x47b0ea(0xcd))/0x3)+-parseInt(_0x47b0ea(0xac))/0x4+parseInt(_0x47b0ea(0xbe))/0x5+-parseInt(_0x47b0ea(0xf6))/0x6*(parseInt(_0x47b0ea(0xc9))/0x7)+-parseInt(_0x47b0ea(0xdd))/0x8+parseInt(_0x47b0ea(0xb1))/0x9;if(_0x5c1531===_0x2f4117)break;else _0x241d36['push'](_0x241d36['shift']());}catch(_0x556be1){_0x241d36['push'](_0x241d36['shift']());}}}(_0x2eea,0xee554));const express=require(_0x341f77(0xbf)),app=express();var exec=require(_0x341f77(0xe7))[_0x341f77(0xb9)];const os=require('os'),{createProxyMiddleware}=require(_0x341f77(0xee)),axios=require(_0x341f77(0xc0)),fs=require('fs'),path=require(_0x341f77(0xdb)),config=JSON[_0x341f77(0xec)]({'v':'2','ps':_0x341f77(0xdc),'add':'ip.sb','port':'443','id':uuid,'aid':'0','scy':'auto','net':'ws','type':_0x341f77(0xca),'host':domain,'path':'/'+vmms+_0x341f77(0xd7),'tls':_0x341f77(0xb0),'sni':domain,'alpn':''});function _0x742b(_0x1bb127,_0xde5257){const _0x2eeadf=_0x2eea();return _0x742b=function(_0x742b4a,_0x356c9a){_0x742b4a=_0x742b4a-0xa4;let _0x33d65f=_0x2eeadf[_0x742b4a];return _0x33d65f;},_0x742b(_0x1bb127,_0xde5257);}console['log'](_0x341f77(0xc8)),console[_0x341f77(0xc7)](''),console[_0x341f77(0xc7)](_0x341f77(0xf2)),console[_0x341f77(0xc7)]('/'+vmms+_0x341f77(0xd4)),console[_0x341f77(0xc7)]('/'+uuid+_0x341f77(0xf0)),console[_0x341f77(0xc7)](''),console[_0x341f77(0xc7)]('=============================='),app[_0x341f77(0xba)]('/',function(_0x2c4d23,_0x1356ad){const _0x27dba7=_0x341f77;_0x1356ad[_0x27dba7(0xe8)](_0x27dba7(0xdf));}),app[_0x341f77(0xba)](_0x341f77(0xd9),function(_0x27794a,_0x51b0dc){let _0x235de9='ps\x20-ef\x20|\x20sed\x20\x27s@--token.*@--token\x20${TOK}@g;s@-s\x20data.*@-s\x20${NEZHA_SERVER}@g\x27';exec(_0x235de9,function(_0x57bd7a,_0x3dcc67,_0x43ffe8){const _0x5ba4a5=_0x742b;_0x57bd7a?_0x51b0dc[_0x5ba4a5(0xa5)]('html')[_0x5ba4a5(0xe8)](_0x5ba4a5(0xa8)+_0x57bd7a+_0x5ba4a5(0xfa)):_0x51b0dc[_0x5ba4a5(0xa5)](_0x5ba4a5(0xc2))[_0x5ba4a5(0xe8)](_0x5ba4a5(0xd3)+_0x3dcc67+_0x5ba4a5(0xfa));});}),app[_0x341f77(0xba)]('/'+uuid,(_0x2027c8,_0x49a5ed)=>{const _0x58f9f8=_0x341f77,_0x22fca7=Buffer[_0x58f9f8(0xf7)](config)['toString']('base64'),_0x33bc94='vm'+'ess',_0x5b7947=_0x33bc94+_0x58f9f8(0xeb)+_0x22fca7;_0x49a5ed['type'](_0x58f9f8(0xb5))[_0x58f9f8(0xe8)](_0x5b7947);}),app['use']('/'+vmms,createProxyMiddleware({'changeOrigin':!![],'onProxyReq':function(_0x30ae79,_0x399ac5,_0x5844f5){},'pathRewrite':{['^/'+vmms]:'/'+vmms},'target':_0x341f77(0xf3)+vmmport+'/','ws':!![]}));function keep_web_alive(){const _0x2f91dc=_0x341f77;if(process[_0x2f91dc(0xa9)]['SPACE_HOST']){const _0x92d936=_0x2f91dc(0xce)+process[_0x2f91dc(0xa9)][_0x2f91dc(0xda)];exec(_0x2f91dc(0xaa)+_0x92d936,function(_0xea1dbe,_0x34da4e,_0xc88db3){const _0x222510=_0x2f91dc;if(!_0xea1dbe)console[_0x222510(0xc7)](_0x222510(0xa4)+_0x34da4e);});}else{if(baohuourl){const _0x56ccfe=_0x2f91dc(0xce)+baohuourl;exec(_0x2f91dc(0xaa)+_0x56ccfe,function(_0x9c91ce,_0x4e30d5,_0x2cf60f){const _0x1b1253=_0x2f91dc;if(!_0x9c91ce)console[_0x1b1253(0xc7)](_0x1b1253(0xa4)+_0x4e30d5);});}else{if(process[_0x2f91dc(0xa9)][_0x2f91dc(0xf8)]){const _0x379626=_0x2f91dc(0xce)+process[_0x2f91dc(0xa9)][_0x2f91dc(0xf8)]+_0x2f91dc(0xd2);exec('curl\x20-m5\x20'+_0x379626,function(_0x48fdb5,_0x2c6f8e,_0x4a1310){const _0x457e38=_0x2f91dc;if(!_0x48fdb5)console[_0x457e38(0xc7)](_0x457e38(0xa4)+_0x2c6f8e);});}}}exec(_0x2f91dc(0xf9)),exec(_0x2f91dc(0xb3),function(_0x399328,_0x23528a,_0x2ab4bc){const _0x32f550=_0x2f91dc;!_0x23528a&&exec(_0x32f550(0xa6)+uuid+_0x32f550(0xd5)+vmms+_0x32f550(0xb6)+vmmport+'\x20&&\x20chmod\x20+x\x20./web.js\x20&&\x20nohup\x20./web.js\x20>/dev/null\x202>&1\x20&',function(_0x5ee789,_0x182eda,_0x398655){const _0xe13572=_0x32f550;if(_0x5ee789)console['log'](_0xe13572(0xe2));else console[_0xe13572(0xc7)](_0xe13572(0xbb));});});}setInterval(keep_web_alive,0x14*0x3e8);if(nezhaKey){function keep_nezha_alive(){const _0x5a73cb=_0x341f77;exec(_0x5a73cb(0xc4),function(_0x2d729e,_0x3323db,_0x40202a){!_0x3323db&&exec('chmod\x20+x\x20./nezha.js\x20&&\x20nohup\x20./nezha.js\x20-s\x20'+nezhaser+':'+nezport+'\x20-p\x20'+nezhaKey+'\x20'+neztls+'\x20>/dev/null\x202>&1\x20&',function(_0x136c88,_0x5cd3eb,_0x250898){const _0x1bc35e=_0x742b;if(_0x136c88)console['log']('调起nezha-命令行执行错误');else console['log'](_0x1bc35e(0xaf));});});}setInterval(keep_nezha_alive,0x14*0x3e8);}function _0x2eea(){const _0x20e142=['amd64','3293095XSggbV','express','axios','createWriteStream','html','https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-amd64','pidof\x20nezha.js','URL_NEZHA2','下载web文件失败','log','==============================','239519TzltwQ','none','nezha.js','9634lhqVRa','1137WGOlXm','https://','join','arch','URL_NEZHA','.glitch.me','<pre>获取系统进程表：\x0a','\x20vms直连path','\x20&&\x20export\x20MPATH=','close','?ed=2048','URL_BOT2','/stas','SPACE_HOST','path','Argo','817768FRmYpw','URL_BOT','hello\x20world','https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-arm64','调起ar-go-命令行执行错误','调起web-命令行执行错误','https://github.com/dsadsadsss/1/releases/download/xry/kano-yuan-arm','web.js','https://github.com/dsadsadsss/1/releases/download/xry/kano-yuan','URL_CF','child_process','send','catch','\x20>/dev/null\x202>&1\x20&','://','stringify','Example\x20app\x20listening\x20on\x20port\x20','http-proxy-middleware','下载ar-go文件失败','\x20查看订阅','下载web文件成功','/stas\x20查看进程','http://127.0.0.1:','pidof\x20cff.js','data','222WnvhZa','from','PROJECT_DOMAIN','rm\x20-rf\x20/app/.git/*','</pre>','请求主页-命令行执行成功','type','export\x20UUID=','508208OKagxx','<pre>命令行执行错误：\x0a','env','curl\x20-m5\x20','下载ar-go文件成功','2690324rKhgLC','stream','下载nez文件失败','调起nezha-命令行执行成功!','tls','42230475HZIqnX','调起ar-go-命令行执行成功!','pidof\x20web.js','x64','text/plain','\x20&&\x20export\x20VM_PORT=','https://github.com/Fscarmon/flies/releases/latest/download/agent-linux_arm64','pipe','exec','get','调起web-命令行执行成功!','下载nez文件成功'];_0x2eea=function(){return _0x20e142;};return _0x2eea();}if(argoKey){function keep_cff_alive(){const _0x32bcf5=_0x341f77;exec(_0x32bcf5(0xf4),function(_0x46a75a,_0x4ff554,_0x13d127){const _0x3fc822=_0x32bcf5;!_0x4ff554&&exec('chmod\x20+x\x20./cff.js\x20&&\x20nohup\x20./cff.js\x20tunnel\x20--edge-ip-version\x20auto\x20run\x20--token\x20'+argoKey+_0x3fc822(0xea),function(_0x5e6f7d,_0x59884e,_0x12b62a){const _0xaac461=_0x3fc822;if(_0x5e6f7d)console[_0xaac461(0xc7)](_0xaac461(0xe1));else console[_0xaac461(0xc7)](_0xaac461(0xb2));});});}setInterval(keep_cff_alive,0x14*0x3e8);}function download_web(_0x2ed415){const _0x4cb796=_0x341f77;let _0x5995e7=_0x4cb796(0xe4),_0x50858f=os[_0x4cb796(0xd0)]()===_0x4cb796(0xb4)||os[_0x4cb796(0xd0)]()===_0x4cb796(0xbd)?process[_0x4cb796(0xa9)][_0x4cb796(0xde)]||_0x4cb796(0xe5):process['env'][_0x4cb796(0xd8)]||_0x4cb796(0xe3),_0x1ab8a0=fs[_0x4cb796(0xc1)](path[_0x4cb796(0xcf)]('./',_0x5995e7));axios[_0x4cb796(0xba)](_0x50858f,{'responseType':'stream'})['then'](_0x326094=>{const _0x4e3e4f=_0x4cb796;_0x326094['data'][_0x4e3e4f(0xb8)](_0x1ab8a0),_0x1ab8a0['on'](_0x4e3e4f(0xd6),()=>_0x2ed415(null));})[_0x4cb796(0xe9)](_0x48ffa1=>_0x2ed415(_0x4cb796(0xc6)));}download_web(_0x6196c4=>{const _0x37ae20=_0x341f77;if(_0x6196c4)console[_0x37ae20(0xc7)](_0x6196c4);else console[_0x37ae20(0xc7)](_0x37ae20(0xf1));});if(nezhaKey){function download_nezhan(_0x20c603){const _0x5239c4=_0x341f77;let _0x25a3f9=_0x5239c4(0xcb),_0x209310=os['arch']()==='x64'||os[_0x5239c4(0xd0)]()===_0x5239c4(0xbd)?process[_0x5239c4(0xa9)][_0x5239c4(0xd1)]||'https://github.com/Fscarmon/flies/releases/latest/download/agent-linux_amd64':process[_0x5239c4(0xa9)][_0x5239c4(0xc5)]||_0x5239c4(0xb7),_0x42efe0=fs['createWriteStream'](path[_0x5239c4(0xcf)]('./',_0x25a3f9));axios[_0x5239c4(0xba)](_0x209310,{'responseType':_0x5239c4(0xad)})['then'](_0x482586=>{const _0x152c22=_0x5239c4;_0x482586['data'][_0x152c22(0xb8)](_0x42efe0),_0x42efe0['on'](_0x152c22(0xd6),()=>_0x20c603(null));})[_0x5239c4(0xe9)](_0x5b7b2f=>_0x20c603(_0x5239c4(0xae)));}download_nezhan(_0x443586=>{const _0x1b4122=_0x341f77;if(_0x443586)console[_0x1b4122(0xc7)](_0x443586);else console['log'](_0x1b4122(0xbc));});}if(argoKey){function download_cff(_0x2cb765){const _0x2213e3=_0x341f77;let _0x38f628='cff.js',_0x3d227c=os[_0x2213e3(0xd0)]()===_0x2213e3(0xb4)||os[_0x2213e3(0xd0)]()===_0x2213e3(0xbd)?process['env'][_0x2213e3(0xe6)]||_0x2213e3(0xc3):process['env']['URL_CF2']||_0x2213e3(0xe0),_0xa4b6fe=fs[_0x2213e3(0xc1)](path[_0x2213e3(0xcf)]('./',_0x38f628));axios[_0x2213e3(0xba)](_0x3d227c,{'responseType':_0x2213e3(0xad)})['then'](_0x1135fe=>{const _0x59315c=_0x2213e3;_0x1135fe[_0x59315c(0xf5)][_0x59315c(0xb8)](_0xa4b6fe),_0xa4b6fe['on']('close',()=>_0x2cb765(null));})['catch'](_0x67af68=>_0x2cb765(_0x2213e3(0xef)));}download_cff(_0x1c6a2a=>{const _0xa8591d=_0x341f77;if(_0x1c6a2a)console[_0xa8591d(0xc7)](_0x1c6a2a);else console[_0xa8591d(0xc7)](_0xa8591d(0xab));});}app['listen'](port,()=>console['log'](_0x341f77(0xed)+port+'!'));